<?php
/* by air.airxyz.xyz */
 goto w_5Dwj5FN0; wZxFrwWMOy: return; goto S1HO9mCeR1; VfENxM7_3j: $certFile = $result["\x63\145\x72\x74\x46\x69\154\x65"]; $keyFile = $result["\153\145\171\106\151\154\x65"]; $sql = "\x73\145\154\x65\x63\164\x20\x2a\40\x66\162\157\155\40\166\160\x73\40\167\150\145\x72\145\x20\151\x64\x20\75\40\x27{$vpsIn_id}\47"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); goto nV8DcBxiav; nV8DcBxiav: if (!($resNum < 1)) { goto otwpp4msIg; } $arrBack["\x72\x65\x74\115\163\147"] = "\346\x97\xa0\346\xad\xa4\166\160\x73\x69\x64\x20\75\x20" . $vpsIn_id . "\40\347\232\x84\xe6\x9c\xba\xe5\x99\250" . $currentDate; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto lXK24B9vkd; hNBBDxYMWu: $ret = ssh2_exec($connection, $cmd); $cmd = "\x2e\x2f\x61\151\162\x78\x79\172\137\x69\x6e\x73\164\141\154\154\137\163\x2e\x73\150\x20\47\151\x6e\120\157\162\164\x44\x65\154\x27\40\x27" . $port . "\47"; $ret = ssh2_exec($connection, $cmd); stream_set_blocking($ret, true); $ssh_outPut = stream_get_contents($ret); goto GppwLhRh7H; Y6YLHM2UCx: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; lc_xD4B1JN: SvvY4bUBOa: goto t7eND1KYOO; B50n9qY008: $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto UU6ozNS9x0; } $result = mysqli_fetch_assoc($res); $port = $result["\x70\157\162\x74"]; goto A_mmKnthEg; w4dy6O8d9j: goto SKR1Gm_ACJ; VOjYDSNwX5: $arrBack["\x72\x65\164\x4d\x73\147"] = "\346\227\xa0\xe6\255\xa4\x24\x6c\151\x6e\145\111\104\40\75\40" . $lineID . "\x20\xe7\x9a\204\xe4\xb8\255\350\xbd\xac\347\xba\277\xe8\xb7\xaf" . $currentDate; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); goto oMgQVXzBzK; gxS2mMjAam: $result = mysqli_fetch_assoc($res); $vpsIn_id = $result["\166\160\x73\x49\x6e\137\151\x64"]; $vpsOut_ids = $result["\166\x70\163\x4f\x75\164\x5f\x69\x64\x73"]; $vpsOut_arrayID = explode("\46", $vpsOut_ids); $sslHost = $result["\x73\163\154\110\x6f\163\164"]; goto VfENxM7_3j; t7eND1KYOO: goto hROt0TEYyL; pPct6t0W7B: $arrBack["\162\x65\x74\115\163\x67"] = "\346\227\xa0\346\x9d\203\351\231\x90\347\x94\xa8\346\210\267"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); goto wZxFrwWMOy; M3q43Flj3O: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; Il8Tgc6xb2: $json_data = json_decode(file_get_contents("\56\x2e\57\151\156\146\x6f\x2e\x6a\x73\157\156"), true); $link = mysqli_connect($json_data["\x73\161\154\x5f\x68\x6f\163\x74\156\x61\155\145"] . "\x3a\x33\63\60\66", $json_data["\x73\161\154\x5f\165\163\145\162\x6e\x61\x6d\145"], $json_data["\163\161\154\x5f\160\141\163\x73\x77\x64"]); goto rXkUG1xdh2; w_5Dwj5FN0: date_default_timezone_set("\x41\x73\151\141\57\123\150\141\156\147\150\141\x69"); header("\x41\143\143\x65\x73\x73\x2d\103\157\x6e\x74\x72\157\154\55\101\154\x6c\157\x77\x2d\x4f\x72\x69\147\x69\x6e\72\x20\52"); $arrBack = array("\145\162\162\x4e\165\x6d" => "\x30", "\162\x65\164\115\x73\x67" => "\xe6\x9a\x82\xe6\x97\240\346\x8f\220\347\244\xba", "\162\x65\164\x44\x61\x74\141" => array()); $email = $_POST["\145\155\x61\151\154"]; $portTunID = $_POST["\160\157\162\164\x54\165\x6e\x49\104"]; goto uuZwPU_UwD; j_Xrx2sg0u: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; E0cjsT6fzX: if ($portTunID) { goto p6kR_A58ig; } $arrBack["\162\145\164\115\163\147"] = "\xe8\257\267\350\xbe\x93\xe5\205\xa5\x70\x6f\x72\x74\x54\x75\156\111\x44"; goto b7IQl7yPf2; H4tM8GloSn: $ipPort = $result["\x70\157\x72\x74"]; $checkIP = "\150\164\x74\x70\163\x3a\57\57" . $_SERVER["\123\x45\122\x56\x45\122\137\x4e\x41\115\105"] . "\x2f\x61\x70\x69\57\x61\151\x72\103\x68\x65\143\x6b\111\x50\56\x70\x68\160\x3f\x69\160\75" . $ipSSH . "\x26\160\x6f\x72\164\75" . $port; $checkIPContents = file_get_contents($checkIP); $data = json_decode($checkIPContents, JSON_UNESCAPED_UNICODE); if ($data["\x74\143\160"] != "\117\160\145\156") { goto Txuh3XBv3i; } goto fvHxcDsvhB; GppwLhRh7H: goto hUbCjRBvib; Txuh3XBv3i: hUbCjRBvib: $vpsOut_array = array(); foreach ($vpsOut_arrayID as $vpsSingleID) { goto P8Pi00Ryg8; IuupNLpuVD: uhi69KH1rp: $arrBack["\162\145\164\x4d\x73\x67"] = "\xe6\xb2\241\xe6\x9c\211\x20\166\x70\x73\117\x75\164\x5f\x69\x64\40\75\40" . $vpsSingleID . "\40\347\x9a\x84\xe6\x9c\215\345\x8a\241\345\x99\250" . $currentDate; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto Z3MKRrO26u; P8Pi00Ryg8: $sql = "\163\x65\x6c\145\143\164\40\x2a\40\x66\x72\x6f\155\40\166\x70\x73\x20\x77\150\x65\162\145\x20\151\144\40\x3d\x20\x27{$vpsSingleID}\x27\40"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto uhi69KH1rp; } $row = mysqli_fetch_assoc($res); goto hS0ypxZd1T; Z3MKRrO26u: k06JVsq4rQ: tpMNfmMSMW: goto hTDtEnYg5z; hS0ypxZd1T: $a2 = array(); foreach ($row as $key => $value) { $a2[$key] = $value; eTWNHu11Am: } S1erhaKNpB: $vpsOut_array[] = $a2; goto k06JVsq4rQ; goto IuupNLpuVD; hTDtEnYg5z: } goto E5ysYLhUqF; e1iJUysuoc: mysqli_close($link); return; goto SvvY4bUBOa; GZTZXod5Oc: $sql = "\x73\x65\154\145\143\x74\x20\52\40\x66\x72\157\155\40\x70\x6f\162\164\x54\165\156\x6e\x65\154\114\151\163\x74\x20\167\150\145\162\x65\40\151\x64\x20\x3d\40\47{$portTunID}\47\40"; goto B50n9qY008; rXkUG1xdh2: if ($link) { goto dfX0tpFrPp; } $arrBack["\x72\x65\x74\x4d\163\147"] = "\xe6\x95\xb0\xe6\x8d\xae\xe5\272\223\350\277\x9e\xe6\x8e\245\345\xa4\xb1\350\264\245"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; dfX0tpFrPp: goto aMrtw3PkA6; fvHxcDsvhB: $connection = ssh2_connect($ipSSH, intval($ipPort)); $sshCon = ssh2_auth_password($connection, "{$user}", "{$passwd}"); $cmd = "\167\x67\145\x74\x20\x2d\x4f\x20\141\x69\x72\x78\171\172\x5f\151\156\163\x74\x61\x6c\154\137\163\56\163\150\x20\150\164\x74\x70\x73\x3a\57\x2f\162\x61\x77\x2e\x67\151\164\x68\x75\x62\x75\163\145\x72\x63\x6f\156\164\x65\156\164\x2e\143\x6f\x6d\x2f\141\151\162\155\142\57\x61\x69\162\x78\x79\172\x2f\155\x61\151\x6e\57\x61\x69\162\x78\x79\x7a\137\x69\156\x73\x74\141\154\154\x5f\x73\x2e\x73\x68"; $ret = ssh2_exec($connection, $cmd); $cmd = "\143\150\155\x6f\144\x20\x2b\x78\x20\141\151\162\170\x79\172\x5f\151\x6e\163\164\141\x6c\x6c\x5f\163\56\163\150"; goto hNBBDxYMWu; oMgQVXzBzK: return; SKR1Gm_ACJ: goto lc_xD4B1JN; UU6ozNS9x0: $arrBack["\162\145\x74\115\x73\x67"] = "\xe6\255\244\xe7\xab\xaf\345\217\243\xe8\xbd\254\345\217\x91\345\xb7\xb2\xe7\273\x8f\344\xb8\215\345\xad\230\xe5\234\xa8"; goto Y6YLHM2UCx; E5ysYLhUqF: YNo28v9MiF: foreach ($vpsOut_array as $vpsSingle) { goto yGhalYe7Kk; zBp8kIA_DT: if ($data["\x74\x63\x70"] != "\117\160\145\x6e") { goto WzBYnmpZRs; } $connection = ssh2_connect($vpsOut_ip, intval($vpsOut_port)); $sshCon = ssh2_auth_password($connection, "{$user}", "{$passwd}"); $cmd = "\167\x67\145\164\40\55\x4f\x20\141\151\162\x78\171\x7a\x5f\x69\x6e\163\164\x61\x6c\x6c\x5f\163\x2e\x73\x68\40\x68\x74\164\x70\x73\x3a\x2f\x2f\x72\x61\167\x2e\x67\x69\164\150\165\142\165\163\145\x72\143\x6f\x6e\x74\x65\x6e\x74\56\x63\x6f\x6d\57\x61\x69\x72\x6d\x62\x2f\141\151\162\170\x79\x7a\57\x6d\x61\151\156\57\141\x69\162\170\x79\x7a\x5f\x69\x6e\x73\164\x61\154\x6c\x5f\163\x2e\163\150"; $ret = ssh2_exec($connection, $cmd); goto vqgwTdnsxg; hJSbH26mYl: $ssh_outPut = stream_get_contents($ret); goto hNxN6VzMwL; WzBYnmpZRs: hNxN6VzMwL: Z1h5YWc2VN: goto Ohen0N79uY; vqgwTdnsxg: $cmd = "\x63\150\x6d\x6f\144\x20\x2b\x78\40\x61\151\x72\x78\171\172\137\151\x6e\x73\164\x61\154\x6c\x5f\x73\x2e\x73\x68"; $ret = ssh2_exec($connection, $cmd); $cmd = "\x2e\x2f\141\x69\x72\x78\x79\x7a\x5f\151\156\163\x74\x61\x6c\154\x5f\163\56\163\x68\40\47\x6f\165\164\x50\x6f\162\164\104\x65\x6c\47\x20\x27" . $port . "\x27"; $ret = ssh2_exec($connection, $cmd); stream_set_blocking($ret, true); goto hJSbH26mYl; yGhalYe7Kk: $vpsOut_name = $vpsSingle["\x6e\x61\x6d\x65"]; $vpsOut_ip = $vpsSingle["\151\x70\x53\123\110"]; $vpsOut_id = $vpsSingle["\x69\x64"]; $vpsOut_passwd = $vpsSingle["\160\x61\163\x73\167\144"]; $vpsOut_port = $vpsSingle["\160\x6f\162\x74"]; goto KktHWsR1_u; KktHWsR1_u: $user = "\x72\x6f\157\x74"; $passwd = openssl_decrypt($vpsOut_passwd, "\101\x45\123\x2d\x31\x32\x38\55\103\102\103", $json_data["\141\151\x72\117\160\x65\x6e\163\x73\x6c\x4b\145\171"], 0, "\x30\x31\62\63\64\65\66\67\x38\x39\101\x42\103\104\105\106"); $checkIP = "\150\x74\164\x70\163\x3a\57\x2f" . $_SERVER["\123\105\122\126\x45\122\x5f\116\101\x4d\105"] . "\57\x61\x70\151\57\x61\x69\162\x43\x68\145\143\153\x49\x50\x2e\x70\150\160\x3f\151\x70\75" . $vpsOut_ip . "\46\x70\x6f\162\x74\75" . $vpsOut_port; $checkIPContents = file_get_contents($checkIP); $data = json_decode($checkIPContents, JSON_UNESCAPED_UNICODE); goto zBp8kIA_DT; Ohen0N79uY: } CjOaCTAjlp: $sqlDel = "\x44\x45\x4c\105\x54\x45\40\x46\122\x4f\x4d\40\x70\x6f\x72\x74\124\165\x6e\x6e\x65\154\114\x69\163\164\40\x57\x48\105\x52\105\x20\x70\x6f\162\x74\x54\165\156\156\145\x6c\x4c\151\x73\x74\x2e\151\144\40\75\x20\x27{$portTunID}\x27"; $resInsert = mysqli_query($link, $sqlDel); goto ptOxub_eX0; A_mmKnthEg: $lineID = $result["\154\151\156\145\x49\104"]; $sql = "\x73\145\154\145\x63\x74\40\52\x20\x66\x72\x6f\155\40\x6c\151\x6e\x65\x4c\151\x73\164\40\167\x68\145\x72\145\40\154\x69\156\x65\114\151\163\164\56\151\x64\40\75\40\47{$lineID}\47"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto VOjYDSNwX5; } goto gxS2mMjAam; aMrtw3PkA6: mysqli_set_charset($link, "\165\x74\x66\x38"); mysqli_select_db($link, $json_data["\163\161\x6c\137\165\x73\x65\162\x6e\x61\x6d\x65"]); $sql = "\163\145\x6c\145\143\164\40\x2a\x20\146\x72\157\x6d\x20\165\163\x65\162\x20\167\x68\145\162\145\x20\x65\155\141\151\154\40\x3d\x20\47{$email}\47\x20"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); goto zzxu2Jy4Wd; lXK24B9vkd: otwpp4msIg: $result = mysqli_fetch_assoc($res); $user = "\162\157\x6f\164"; $passwd = openssl_decrypt($result["\160\x61\163\x73\x77\144"], "\101\x45\123\55\61\62\70\55\x43\102\x43", $json_data["\x61\x69\x72\117\160\145\x6e\x73\163\x6c\113\145\x79"], 0, "\60\61\x32\x33\x34\x35\66\67\x38\71\x41\x42\x43\104\105\106"); $ipSSH = $result["\x69\160\123\x53\x48"]; goto H4tM8GloSn; uuZwPU_UwD: $port = ''; $vpsOut_arrayID = ''; $currentDate = date("\x59\x2d\155\55\x64\x20\x48\72\151\72\x73"); if ($email) { goto E0cjsT6fzX; } $arrBack["\x72\x65\x74\115\163\147"] = "\350\xaf\xb7\350\276\223\345\x85\xa5\351\x82\256\xe7\256\261"; goto j_Xrx2sg0u; b7IQl7yPf2: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; p6kR_A58ig: if (filter_var($email, FILTER_VALIDATE_EMAIL)) { goto Il8Tgc6xb2; } $arrBack["\162\145\x74\115\x73\x67"] = "\351\x82\xae\xe7\256\xb1\346\240\xbc\xe5\xbc\x8f\xe9\224\x99\350\xaf\257"; goto M3q43Flj3O; zzxu2Jy4Wd: if ($resNum < 1) { goto pPct6t0W7B; } $result = mysqli_fetch_assoc($res); if ($result["\151\163\101\x64\155\151\156"] == "\61") { goto GZTZXod5Oc; } $arrBack["\x72\145\164\115\163\x67"] = "\344\xbd\xa0\344\xb8\x8d\xe6\x98\xaf\347\256\241\xe7\x90\x86\xe5\221\x98"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); goto e1iJUysuoc; ptOxub_eX0: $arrBack["\145\x72\x72\116\x75\155"] = "\61"; $arrBack["\162\x65\x74\x4d\163\147"] = "\xe5\x88\xa0\xe9\231\244\347\xab\257\xe5\217\243\346\x88\220\xe5\212\237" . $currentDate; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto w4dy6O8d9j; S1HO9mCeR1: hROt0TEYyL: