<?php
/* air.airxyz.xyz */
 goto VUDptkC31t; qI1f72Arjt: $sql = "\163\x65\154\x65\x63\164\40\x2a\40\146\162\157\155\40\x70\157\x72\164\x54\x75\x6e\156\145\x6c\114\x69\163\x74\x20\x77\150\145\162\x65\x20\x70\157\x72\164\x54\165\156\x6e\x65\x6c\x4c\151\163\164\x2e\160\157\x72\164\40\75\40\47{$port}\47\x20\141\x6e\144\40\160\157\162\x74\x54\165\156\156\145\x6c\114\151\x73\x74\56\x6c\x69\156\145\x49\x44\x20\x3d\x20\x27{$lineID}\x27"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto pwvH13DiFx; } $arrBack["\x72\145\x74\x4d\163\x67"] = "\346\255\xa4\347\253\xaf\xe5\217\243\345\234\250\346\255\244\347\272\xbf\xe8\xb7\257\345\xb7\xb2\xe7\xbb\x8f\346\xb7\xbb\345\212\240\350\277\x87\344\xba\x86"; goto NtQfgc703o; HcOBmoUbaq: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; Y0apWLzFwL: MgHQLE_SQs: goto nBgEklhlcb; S7IjJY0Di_: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto MgHQLE_SQs; PTogjsjsP8: goto Nf1OPIIiaQ; v0NynbfVsv: aJeoFcnElQ: mysqli_set_charset($link, "\165\x74\x66\70"); mysqli_select_db($link, $json_data["\163\x71\x6c\x5f\165\x73\x65\162\156\141\x6d\145"]); $sql = "\163\145\x6c\x65\143\x74\40\52\x20\146\x72\157\x6d\x20\x75\163\x65\x72\x20\167\x68\145\x72\x65\40\145\155\x61\x69\x6c\x20\75\40\47{$email}\x27\x20"; $res = mysqli_query($link, $sql); goto pjnWYlFHds; nBgEklhlcb: goto hlivx20oW9; Yzhj_6DvrY: $arrBack["\162\x65\164\115\163\147"] = "\346\227\xa0\346\x9d\203\xe9\x99\220\xe7\x94\250\346\x88\xb7"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); goto N9arF_eqYa; g8No20ZRzm: $vpsIn_id = ''; $vpsOut_ids = ''; $sslHost = ''; $certFile = ''; $keyFile = ''; goto y5MOUW5U8g; Nf1OPIIiaQ: $stream_opts = ["\163\163\x6c" => ["\166\x65\162\x69\146\x79\137\x70\145\x65\162" => false, "\x76\145\162\x69\146\x79\x5f\160\x65\x65\x72\x5f\x6e\141\x6d\x65" => false]]; $iptolocation = "\150\164\164\x70\163\x3a\57\57" . $_SERVER["\123\105\122\x56\105\x52\137\x4e\x41\x4d\x45"] . "\57\x61\160\151\x2f\x61\x69\162\x43\x68\145\x63\x6b\x49\x50\x2e\160\150\160\77\151\160\75" . $toIP . "\x26\x70\157\162\164\x3d" . $toPort; $creatorlocation = file_get_contents($iptolocation, false, stream_context_create($stream_opts)); $data = json_decode($creatorlocation, JSON_UNESCAPED_UNICODE); if (!($data["\164\143\x70"] != "\x4f\160\x65\156")) { goto UPGASxYFq3; } goto EbX5ZZKyo1; pjnWYlFHds: $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto Yzhj_6DvrY; } $result = mysqli_fetch_assoc($res); if ($result["\151\163\x41\144\x6d\151\x6e"] == "\x31") { goto PTogjsjsP8; } $arrBack["\162\145\x74\115\163\147"] = "\344\xbd\xa0\344\xb8\x8d\346\x98\xaf\347\256\xa1\347\220\x86\345\221\x98"; goto S7IjJY0Di_; jV35COvXMd: $arrBack["\162\145\x74\115\x73\x67"] = "\xe6\x97\240\346\255\xa4\x76\160\x73\x69\x64\x20\x3d\x20" . $vpsIn_id . "\x20\347\x9a\x84\346\x9c\xba\345\x99\xa8"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; uWpB2lyXM_: goto qBVT51ns0Z; dcjGGXOd5_: $arrBack["\162\145\164\115\x73\147"] = "\346\x97\xa0\346\255\244\x24\154\x69\x6e\145\x49\104\40\x3d\x20" . $lineID . "\40\347\x9a\204\xe4\270\255\350\275\254\347\272\277\350\xb7\257"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; COLhzTu78i: goto qI1f72Arjt; XrWvUx_9FE: $cmd = "\x63\150\155\x6f\144\40\53\170\40\x61\151\162\x78\x79\172\137\151\156\163\164\141\154\x6c\137\163\x2e\163\x68"; $ret = ssh2_exec($connection, $cmd); $cmd = "\x2e\57\141\151\x72\x78\171\x7a\137\x69\x6e\x73\164\141\154\154\x5f\x73\56\163\x68\x20\x27\151\x6e\x50\x6f\162\x74\x41\x64\x64\x27\40\47" . $port . "\x27\x20\47" . $sslHost . "\x27"; $ret = ssh2_exec($connection, $cmd); stream_set_blocking($ret, true); goto Dv5ZY7nXxc; NtQfgc703o: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto Y0apWLzFwL; pwvH13DiFx: goto qVKOWlAYB1; y5MOUW5U8g: $vpsOut_server = "\x73\145\x72\166\145\162\40" . $toIP . "\72" . $toPort . "\73"; $vpsOut_arrayID = array(); $sql = "\x73\x65\154\x65\x63\x74\x20\52\x20\x66\x72\157\155\40\154\x69\x6e\x65\114\151\163\x74\40\167\150\x65\x72\145\x20\154\x69\x6e\x65\114\151\x73\164\x2e\x69\x64\40\75\40\47{$lineID}\47"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); goto drPbby3b2p; drPbby3b2p: if ($resNum < 1) { goto LkWsrdKIv4; } $result = mysqli_fetch_assoc($res); $vpsIn_id = $result["\x76\x70\163\x49\156\137\151\x64"]; $vpsOut_ids = $result["\x76\160\x73\x4f\x75\x74\x5f\x69\144\x73"]; $vpsOut_arrayID = explode("\x26", $vpsOut_ids); goto PfR9QHLZGa; Zoz9fZXVf1: $port = $_POST["\160\157\162\164"]; $toIP = $_POST["\164\157\x49\120"]; $toPort = $_POST["\x74\x6f\120\157\x72\x74"]; $name = $_POST["\x6e\141\155\x65"]; if ($email) { goto rZIejGnSiS; } goto PrhM0KggTQ; EbX5ZZKyo1: $arrBack["\162\145\164\115\163\147"] = "\111\x50\40\346\210\226\xe8\x80\x85\xe7\xab\xaf\xe5\x8f\243\xe4\xb8\215\351\x80\x9a\x20\xe8\257\267\xe6\xa0\270\345\257\xb9\xe5\220\x8e\347\250\x8d\345\220\x8e\xe5\x86\215\xe8\xaf\225"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; UPGASxYFq3: goto g8No20ZRzm; PrhM0KggTQ: $arrBack["\x72\x65\164\x4d\x73\x67"] = "\350\257\xb7\350\xbe\x93\345\x85\245\xe9\202\256\xe7\256\xb1"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; rZIejGnSiS: if ($lineID) { goto rbf9mtqvtk; } goto Ctkw_VXPKM; Ctkw_VXPKM: $arrBack["\162\145\164\115\163\x67"] = "\350\xaf\xb7\350\xbe\223\xe5\x85\245\x24\x6c\x69\x6e\x65\111\104"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; rbf9mtqvtk: if ($port) { goto LOdB27zXFk; } goto DinGDWLbyz; VUDptkC31t: date_default_timezone_set("\101\x73\x69\x61\57\x53\150\141\x6e\147\x68\x61\151"); header("\101\x63\x63\145\x73\163\55\x43\x6f\x6e\164\x72\x6f\154\x2d\101\154\x6c\x6f\x77\x2d\x4f\x72\x69\x67\x69\156\72\40\x2a"); $arrBack = array("\145\162\x72\x4e\x75\x6d" => "\x30", "\x72\x65\164\x4d\x73\147" => "\346\x9a\x82\346\227\240\346\x8f\220\xe7\244\272", "\162\x65\164\104\141\164\141" => array()); $email = $_POST["\x65\155\141\x69\154"]; $lineID = $_POST["\x6c\151\x6e\x65\111\104"]; goto Zoz9fZXVf1; yb9qAuVrcG: $link = mysqli_connect($json_data["\x73\x71\x6c\137\x68\x6f\163\x74\156\141\155\x65"] . "\72\x33\63\x30\66", $json_data["\163\161\154\x5f\165\163\145\162\156\141\155\145"], $json_data["\163\161\154\x5f\160\x61\163\x73\167\x64"]); if ($link) { goto aJeoFcnElQ; } $arrBack["\x72\x65\164\115\163\x67"] = "\346\x95\xb0\346\x8d\256\xe5\272\x93\xe8\277\x9e\346\x8e\xa5\xe5\xa4\261\xe8\xb4\245"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; goto v0NynbfVsv; IziqWiVcA0: $arrBack["\x72\x65\164\115\x73\x67"] = "\350\xaf\xb7\350\276\x93\xe5\205\245\44\x74\157\120\157\x72\164"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; W3A0AVLS81: if (filter_var($email, FILTER_VALIDATE_EMAIL)) { goto EczezQgPX_; } goto mBu7_hPlwH; PfR9QHLZGa: $sslHost = $result["\x73\163\x6c\x48\x6f\163\164"]; $certFile = $result["\143\x65\x72\164\x46\151\154\145"]; $keyFile = $result["\153\145\x79\x46\151\x6c\x65"]; goto COLhzTu78i; LkWsrdKIv4: goto dcjGGXOd5_; N9arF_eqYa: return; goto wE4AJAG_7G; rHZnZEt4qe: mysqli_close($link); return; sWTk73dqeq: $cmd = "\x77\147\145\x74\40\55\x4f\40\x61\x69\162\x78\x79\172\x5f\x69\156\x73\164\x61\154\x6c\x5f\x73\x2e\163\150\40\x68\164\x74\160\163\x3a\57\57\162\x61\167\56\x67\151\164\150\x75\x62\x75\x73\145\x72\143\157\x6e\x74\145\156\x74\56\143\x6f\155\57\x61\x69\162\x6d\142\57\x61\x69\162\x78\x79\x7a\57\x6d\x61\x69\156\x2f\x61\151\162\170\171\172\x5f\x69\156\163\x74\141\x6c\x6c\x5f\163\x2e\163\150"; $ret = ssh2_exec($connection, $cmd); goto XrWvUx_9FE; DinGDWLbyz: $arrBack["\x72\x65\x74\x4d\163\147"] = "\350\xaf\267\350\276\x93\xe5\205\xa5\44\160\x6f\162\x74"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; LOdB27zXFk: if ($toIP) { goto mGZryGq3FS; } goto jVMUYk371I; mBu7_hPlwH: $arrBack["\x72\x65\x74\x4d\x73\147"] = "\351\202\xae\xe7\256\261\346\240\274\xe5\274\x8f\xe9\224\231\350\xaf\257"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; EczezQgPX_: $json_data = json_decode(file_get_contents("\x2e\56\57\151\156\x66\157\x2e\152\163\157\x6e"), true); goto yb9qAuVrcG; qVKOWlAYB1: $currentDate = date("\131\55\155\x2d\x64\40\110\72\151\72\163"); $sql = "\x73\x65\x6c\145\143\x74\40\52\40\x66\162\x6f\155\40\166\x70\163\40\167\x68\145\162\x65\40\x69\144\40\x3d\40\47{$vpsIn_id}\x27"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if (!($resNum < 1)) { goto uWpB2lyXM_; } goto jV35COvXMd; qBVT51ns0Z: $result = mysqli_fetch_assoc($res); $user = "\x72\x6f\x6f\x74"; $passwd = openssl_decrypt($result["\x70\141\163\163\167\144"], "\x41\105\123\x2d\61\x32\70\x2d\x43\x42\x43", $json_data["\141\151\162\117\160\x65\x6e\x73\163\x6c\113\x65\171"], 0, "\60\x31\x32\63\x34\x35\66\67\x38\71\101\x42\x43\104\105\106"); $ipSSH = $result["\151\160\x53\123\110"]; $ipPort = $result["\x70\157\162\x74"]; goto qgdtOsl9CS; Dv5ZY7nXxc: $ssh_outPut = stream_get_contents($ret); $vpsOut_array = array(); foreach ($vpsOut_arrayID as $vpsSingleID) { goto SKHL75sJVD; SKHL75sJVD: $sql = "\163\145\x6c\145\x63\164\40\x2a\x20\x66\x72\x6f\x6d\40\x76\x70\163\x20\167\x68\x65\162\x65\40\151\144\x20\75\40\x27{$vpsSingleID}\x27\40"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto XAq2_wg6Ve; } $row = mysqli_fetch_assoc($res); goto PXKXS_SwjV; yn4RC4YJMg: qJaBCNnuDy: E8ej1OhxDl: goto udk15OCuNS; PXKXS_SwjV: $a2 = array(); foreach ($row as $key => $value) { $a2[$key] = $value; lEVb0Y6mXf: } h1dC_tdmEb: $vpsOut_array[] = $a2; goto qJaBCNnuDy; goto WNcH3vElBu; WNcH3vElBu: XAq2_wg6Ve: $arrBack["\162\x65\164\x4d\163\x67"] = "\xe6\xb2\241\346\x9c\x89\40\166\x70\163\x4f\x75\x74\x5f\151\x64\40\x3d\40" . $vpsSingleID . "\x20\xe7\x9a\x84\346\234\215\345\x8a\xa1\xe5\x99\250"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto yn4RC4YJMg; udk15OCuNS: } gqJccq_4Yq: foreach ($vpsOut_array as $vpsSingle) { goto osqDRySYWr; begsSw7Te2: $cmd = "\167\147\x65\x74\x20\55\117\40\141\x69\x72\x78\171\x7a\137\x69\x6e\163\164\x61\x6c\x6c\137\x73\56\x73\150\x20\150\x74\x74\x70\163\72\57\57\x72\x61\x77\56\x67\151\x74\x68\x75\x62\x75\x73\145\162\x63\157\x6e\164\x65\156\164\56\143\157\155\57\x61\151\162\x6d\x62\x2f\141\x69\x72\170\x79\x7a\x2f\x6d\x61\x69\156\57\141\151\162\170\171\x7a\x5f\151\x6e\163\x74\141\x6c\154\137\x73\x2e\x73\x68"; $ret = ssh2_exec($connection, $cmd); $cmd = "\143\150\155\157\144\x20\x2b\x78\40\141\x69\x72\x78\171\x7a\137\151\x6e\x73\x74\x61\x6c\x6c\137\x73\x2e\x73\150"; $ret = ssh2_exec($connection, $cmd); $cmd = "\x2e\57\141\151\162\x78\x79\x7a\x5f\x69\156\x73\164\x61\154\154\x5f\x73\56\163\150\40\47\x6f\165\x74\120\x6f\162\x74\101\x64\x64\47\x20\x27" . $port . "\47\40\x27" . $certFile . "\47\40\x27" . $keyFile . "\x27\x20\47" . $vpsOut_server . "\x27"; goto kL2UgCoVfz; kL2UgCoVfz: $ret = ssh2_exec($connection, $cmd); stream_set_blocking($ret, true); $ssh_outPut = stream_get_contents($ret); ZNByl6a_qy: goto RrjIHjWCPa; JGM6q8Vya4: $arrBack["\x72\x65\164\115\163\147"] = "\345\x87\xba\xe5\x8f\xa3\347\x9a\204\166\x70\163\347\x9a\204\346\234\272\xe5\231\xa8\40" . $ipSSH . "\40\163\x73\150\350\xbf\236\346\x8e\xa5\xe5\xa4\xb1\xe8\xb4\xa5"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; cPo_eDPwJq: goto begsSw7Te2; osqDRySYWr: $vpsOut_name = $vpsSingle["\156\x61\155\x65"]; $vpsOut_ip = $vpsSingle["\x69\x70\x53\x53\110"]; $vpsOut_id = $vpsSingle["\x69\x64"]; $vpsOut_passwd = $vpsSingle["\160\x61\163\x73\167\x64"]; $vpsOut_port = $vpsSingle["\160\157\x72\x74"]; goto iJo8yru5ot; iJo8yru5ot: $user = "\162\157\x6f\x74"; $passwd = openssl_decrypt($vpsOut_passwd, "\x41\x45\123\x2d\61\62\70\55\103\x42\x43", $json_data["\141\151\162\117\160\145\156\163\x73\154\x4b\145\171"], 0, "\x30\x31\62\63\x34\65\x36\x37\70\71\x41\102\103\x44\105\106"); $connection = @ssh2_connect($vpsOut_ip, intval($vpsOut_port)); $sshCon = @ssh2_auth_password($connection, "{$user}", "{$passwd}"); if ($sshCon) { goto cPo_eDPwJq; } goto JGM6q8Vya4; RrjIHjWCPa: } goto XVJchpgWqA; XVJchpgWqA: e45EWQMMMs: $sqlInsert = "\x49\x4e\123\x45\x52\x54\x20\x49\x4e\x54\x4f\x20\x70\157\x72\164\124\165\156\x6e\x65\154\x4c\x69\163\164\12\x20\x20\x20\x20\40\x20\x20\40\40\x20\x20\x20\50\x6e\141\155\145\x2c\x20\x6c\x69\x6e\145\x49\104\54\x20\160\157\x72\x74\x2c\40\x74\157\111\x50\x2c\40\x74\157\x50\157\x72\x74\54\40\x61\144\x64\124\151\155\145\x2c\x73\x74\141\164\x75\163\51\xa\40\x20\x20\40\40\x20\40\40\40\40\x20\x20\x56\x41\x4c\x55\x45\123\12\40\x20\x20\x20\x20\x20\x20\x20\x20\40\40\x20\50\47{$name}\47\54\47{$lineID}\47\54\40\x27{$port}\x27\x2c\40\47{$toIP}\x27\54\40\47{$toPort}\47\54\x27{$currentDate}\x27\54\x27\61\47\51"; $resInsert = mysqli_query($link, $sqlInsert); $arrBack["\x65\x72\162\116\165\x6d"] = "\61"; $arrBack["\162\145\x74\115\x73\147"] = "\346\267\273\345\x8a\xa0\xe7\253\257\345\x8f\xa3\xe8\xbd\254\xe5\x8f\221\xe6\210\220\345\x8a\237\40" . $currentDate; goto HcOBmoUbaq; jVMUYk371I: $arrBack["\162\x65\x74\115\163\x67"] = "\xe8\xaf\xb7\350\xbe\223\345\205\xa5\x24\x74\x6f\x49\x50"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; mGZryGq3FS: if ($toPort) { goto W3A0AVLS81; } goto IziqWiVcA0; qgdtOsl9CS: $connection = @ssh2_connect($ipSSH, intval($ipPort)); $sshCon = @ssh2_auth_password($connection, "{$user}", "{$passwd}"); if ($sshCon) { goto sWTk73dqeq; } $arrBack["\x72\145\164\x4d\x73\x67"] = "\xe5\205\245\xe5\x8f\xa3\166\x70\163\xe7\232\204\346\x9c\272\xe5\231\xa8\163\x73\150\350\277\236\xe6\x8e\xa5\345\244\xb1\350\264\xa5"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); goto rHZnZEt4qe; wE4AJAG_7G: hlivx20oW9: