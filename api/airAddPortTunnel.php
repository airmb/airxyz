<?php
/* by air.airxyz.xyz */
 goto rZ_ggDUItT; OMjz0SlzRX: $arrBack["\162\x65\164\115\163\x67"] = "\xe9\x82\xae\347\xae\xb1\346\240\xbc\xe5\274\217\xe9\224\231\350\257\257"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; wJdKWumzKK: $json_data = json_decode(file_get_contents("\x2e\x2e\x2f\x69\156\x66\x6f\56\152\163\157\156"), true); goto pAvCNPLMde; jDtRDKjEc6: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; H7XSE1W84_: $result = mysqli_fetch_assoc($res); goto VCkLrN5z4C; rZ_ggDUItT: date_default_timezone_set("\x41\x73\151\141\57\x53\x68\x61\x6e\x67\150\x61\x69"); header("\x41\143\143\x65\163\163\x2d\103\x6f\156\164\x72\157\x6c\55\x41\x6c\x6c\157\167\x2d\x4f\162\x69\x67\151\x6e\x3a\40\52"); $arrBack = array("\x65\x72\x72\116\165\x6d" => "\x30", "\x72\x65\164\115\163\x67" => "\xe6\x9a\202\xe6\227\xa0\xe6\217\x90\347\xa4\xba", "\x72\145\x74\104\141\x74\141" => array()); $email = $_POST["\x65\155\141\x69\x6c"]; $lineID = $_POST["\x6c\x69\156\145\111\104"]; goto YAAHK7mfMp; pAvCNPLMde: $link = mysqli_connect($json_data["\163\161\x6c\x5f\x68\157\x73\164\156\141\155\145"] . "\x3a\x33\x33\60\x36", $json_data["\x73\161\x6c\x5f\165\x73\145\x72\x6e\141\x6d\x65"], $json_data["\x73\161\x6c\x5f\160\141\163\x73\167\144"]); if ($link) { goto o0vvjk9hFv; } $arrBack["\x72\145\164\x4d\x73\147"] = "\xe6\225\xb0\xe6\215\256\345\xba\223\xe8\277\x9e\346\x8e\xa5\xe5\244\261\xe8\xb4\245"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; goto kyrhXUbYRt; CzhARGngeV: $arrBack["\x72\x65\x74\x4d\x73\x67"] = "\xe8\257\xb7\350\xbe\x93\xe5\205\xa5\x24\154\x69\x6e\145\111\104"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; HteWzRI4gS: if ($port) { goto aFbnzcFkzY; } goto iH7scjJiiz; DloXyyoLPU: $vpsOut_arrayID = array(); $sql = "\163\145\x6c\x65\143\x74\x20\52\x20\146\x72\157\155\x20\x6c\151\x6e\145\x4c\151\x73\164\40\167\x68\145\162\145\40\154\151\156\145\x4c\151\163\164\56\151\x64\x20\75\40\47{$lineID}\47"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto arazPx3Nvl; } goto L0cxawmFz2; kyrhXUbYRt: o0vvjk9hFv: mysqli_set_charset($link, "\x75\164\x66\70"); mysqli_select_db($link, $json_data["\163\161\x6c\x5f\165\x73\145\x72\x6e\141\x6d\145"]); $sql = "\x73\145\x6c\x65\x63\164\40\x2a\40\x66\162\157\155\x20\165\x73\145\x72\x20\x77\x68\145\162\145\x20\x65\155\x61\151\154\x20\75\40\47{$email}\47\40"; $res = mysqli_query($link, $sql); goto upbckbvY57; rT5wx4r88q: return; o9An5d3Ick: $cmd = "\x77\147\145\x74\40\x2d\x4f\40\141\x69\x72\x78\171\x7a\x5f\151\x6e\163\x74\x61\x6c\154\137\x73\56\163\150\40\150\x74\164\160\163\x3a\x2f\x2f\x72\x61\167\56\147\151\x74\150\165\x62\x75\163\x65\x72\143\x6f\x6e\x74\x65\156\164\56\x63\x6f\x6d\57\141\x69\x72\155\x62\x2f\x61\151\162\x78\171\x7a\x2f\155\x61\151\156\57\141\151\x72\170\x79\172\137\151\156\x73\164\141\154\154\137\163\56\163\150"; $ret = ssh2_exec($connection, $cmd); $cmd = "\x63\150\x6d\x6f\144\40\x2b\x78\x20\x61\x69\x72\x78\x79\172\x5f\x69\156\163\164\x61\x6c\x6c\137\163\x2e\163\x68"; goto ruIkK3CQFf; QvF8cgIWf0: $sql = "\x73\145\x6c\145\143\164\40\52\x20\146\x72\x6f\x6d\40\x76\160\x73\40\x77\x68\x65\x72\x65\40\x69\x64\x20\75\40\x27{$vpsIn_id}\x27"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if (!($resNum < 1)) { goto H7XSE1W84_; } $arrBack["\x72\145\164\115\163\147"] = "\346\x97\xa0\xe6\xad\xa4\x76\160\163\x69\144\x20\x3d\40" . $vpsIn_id . "\40\xe7\232\204\xe6\234\xba\xe5\x99\250"; goto jDtRDKjEc6; PjDfSoc43X: $iptolocation = "\x68\164\x74\160\163\72\57\57" . $_SERVER["\x53\105\x52\126\105\122\137\x4e\101\115\105"] . "\57\x61\x70\x69\57\141\x69\x72\x43\150\x65\x63\153\111\x50\56\x70\x68\x70\77\x69\160\75" . $toIP . "\46\x70\157\162\x74\x3d" . $toPort; $creatorlocation = file_get_contents($iptolocation); $data = json_decode($creatorlocation, JSON_UNESCAPED_UNICODE); if (!($data["\164\x63\x70"] != "\x4f\160\145\156")) { goto Cl7mejettp; } $arrBack["\162\x65\164\115\x73\x67"] = "\x49\x50\40\346\x88\x96\xe8\x80\x85\347\253\xaf\345\217\243\344\270\x8d\351\x80\232\x20\350\xaf\267\xe6\240\xb8\xe5\xaf\271\345\x90\x8e\xe7\250\215\xe5\x90\x8e\345\x86\x8d\350\xaf\x95"; goto AJKqxX80yj; DQTKJRwnY5: mysqli_close($link); return; goto JyD07OXV1a; Lk_uzcM3yw: $currentDate = date("\x59\55\155\55\144\x20\110\x3a\x69\72\x73"); goto QvF8cgIWf0; qiQeCZsu4A: $vpsOut_ids = ''; $sslHost = ''; $certFile = ''; $keyFile = ''; $vpsOut_server = "\163\145\162\166\145\x72\x20" . $toIP . "\x3a" . $toPort . "\x3b"; goto DloXyyoLPU; L0cxawmFz2: $result = mysqli_fetch_assoc($res); $vpsIn_id = $result["\166\x70\163\111\156\x5f\151\144"]; $vpsOut_ids = $result["\x76\160\163\117\x75\164\137\x69\x64\163"]; $vpsOut_arrayID = explode("\x26", $vpsOut_ids); $sslHost = $result["\x73\x73\x6c\110\157\x73\164"]; goto VqrOZbKg_i; VCkLrN5z4C: $user = "\x72\157\157\x74"; $passwd = openssl_decrypt($result["\160\141\x73\x73\x77\144"], "\x41\x45\123\55\x31\62\70\55\103\102\103", $json_data["\141\x69\x72\117\160\x65\156\163\163\154\x4b\x65\x79"], 0, "\x30\x31\62\63\64\65\x36\x37\70\71\101\102\103\x44\105\106"); $ipSSH = $result["\x69\160\x53\x53\110"]; $ipPort = $result["\x70\157\162\164"]; $connection = @ssh2_connect($ipSSH, intval($ipPort)); goto swK8k4JqME; ZQ0WV7ZZnw: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto UnYfQYectf; k6z5Jy6JMK: goto PjDfSoc43X; CIienJHGZ0: $sqlInsert = "\x49\116\x53\x45\x52\x54\x20\x49\116\124\117\40\160\x6f\x72\164\124\165\x6e\x6e\x65\154\x4c\x69\163\x74\xa\x20\40\40\x20\40\x20\x20\40\40\x20\40\x20\50\x6e\x61\155\145\x2c\x20\154\151\156\145\x49\x44\x2c\40\x70\157\x72\164\54\40\164\157\x49\120\54\40\x74\x6f\x50\x6f\162\164\54\40\x61\144\x64\x54\x69\155\145\x2c\x73\164\x61\164\165\163\51\12\40\40\x20\40\x20\40\40\40\x20\x20\40\x20\x56\x41\x4c\x55\x45\123\12\40\40\40\x20\x20\40\x20\40\40\40\40\x20\50\x27{$name}\x27\x2c\47{$lineID}\x27\x2c\x20\x27{$port}\x27\54\40\x27{$toIP}\x27\54\40\x27{$toPort}\47\x2c\x27{$currentDate}\47\54\x27\61\47\x29"; $resInsert = mysqli_query($link, $sqlInsert); $arrBack["\x65\162\x72\116\165\x6d"] = "\x31"; $arrBack["\x72\x65\x74\x4d\x73\147"] = "\xe6\267\273\xe5\x8a\xa0\347\253\xaf\345\x8f\xa3\350\275\254\xe5\x8f\221\xe6\210\220\xe5\212\237\x20" . $currentDate; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); goto eaEKCqJ3VK; ruIkK3CQFf: $ret = ssh2_exec($connection, $cmd); $cmd = "\x2e\x2f\x61\151\162\x78\171\172\x5f\x69\156\x73\164\141\154\154\x5f\163\x2e\x73\x68\x20\47\151\x6e\x50\x6f\x72\x74\x41\x64\x64\x27\40\47" . $port . "\x27\40\47" . $sslHost . "\47"; $ret = ssh2_exec($connection, $cmd); stream_set_blocking($ret, true); $ssh_outPut = stream_get_contents($ret); goto OEEt46Q2Qb; JFNRqK8hkO: $arrBack["\162\145\x74\115\x73\x67"] = "\xe8\257\267\350\276\x93\345\x85\245\x24\164\x6f\x50\157\162\x74"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; Y02OjKmZL1: if (filter_var($email, FILTER_VALIDATE_EMAIL)) { goto wJdKWumzKK; } goto OMjz0SlzRX; OdkBjVIaLC: CAzNimqDYw: $arrBack["\162\145\x74\115\163\147"] = "\346\x97\240\xe6\x9d\x83\351\231\220\347\224\xa8\xe6\x88\xb7"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto sSKGUIwYWq; wYoXA4IkM0: $arrBack["\x72\145\164\115\163\147"] = "\xe8\257\267\350\276\223\xe5\x85\245\xe9\202\xae\xe7\xae\xb1"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; YXGv0V0Iog: if ($lineID) { goto HteWzRI4gS; } goto CzhARGngeV; VqrOZbKg_i: $certFile = $result["\143\x65\162\164\x46\x69\154\145"]; $keyFile = $result["\x6b\145\x79\x46\151\x6c\145"]; goto b2MUV13SkN; arazPx3Nvl: $arrBack["\162\x65\x74\115\x73\x67"] = "\xe6\x97\240\xe6\255\244\44\154\151\156\145\x49\104\x20\x3d\40" . $lineID . "\40\347\232\x84\xe4\270\255\350\xbd\xac\347\xba\277\350\267\xaf"; goto WdpMHyDpxv; iH7scjJiiz: $arrBack["\x72\145\x74\115\x73\x67"] = "\xe8\257\xb7\xe8\276\x93\345\x85\245\44\160\157\x72\164"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; aFbnzcFkzY: if ($toIP) { goto rpISiWLDA2; } goto UKDsg4_G5l; UKDsg4_G5l: $arrBack["\162\145\x74\115\x73\147"] = "\xe8\257\xb7\350\xbe\x93\345\205\xa5\44\164\157\x49\120"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); return; rpISiWLDA2: if ($toPort) { goto Y02OjKmZL1; } goto JFNRqK8hkO; OEEt46Q2Qb: $vpsOut_array = array(); foreach ($vpsOut_arrayID as $vpsSingleID) { goto eRZxDlViEj; eRZxDlViEj: $sql = "\163\x65\x6c\145\143\164\40\x2a\40\x66\162\157\x6d\x20\x76\x70\163\40\x77\150\x65\x72\145\40\151\144\x20\x3d\x20\47{$vpsSingleID}\x27\x20"; $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto fFzhSK_quR; } $row = mysqli_fetch_assoc($res); goto JdJV0eOpBe; JdJV0eOpBe: $a2 = array(); foreach ($row as $key => $value) { $a2[$key] = $value; q0YmlRUj6s: } q78Rp3zcDE: $vpsOut_array[] = $a2; goto L37tx30gqH; goto TrEjG498ul; L3Bg2Ytgrk: L37tx30gqH: SjRp2L3snm: goto hvOwtH20ta; TrEjG498ul: fFzhSK_quR: $arrBack["\x72\x65\x74\115\163\x67"] = "\xe6\xb2\241\xe6\x9c\x89\40\x76\160\163\x4f\x75\x74\137\x69\144\40\75\x20" . $vpsSingleID . "\40\347\232\x84\xe6\x9c\215\xe5\x8a\241\345\231\xa8"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; goto L3Bg2Ytgrk; hvOwtH20ta: } QKIFWx1SSk: foreach ($vpsOut_array as $vpsSingle) { goto nJst9TS1gw; nJst9TS1gw: $vpsOut_name = $vpsSingle["\x6e\x61\155\145"]; $vpsOut_ip = $vpsSingle["\x69\160\123\123\x48"]; $vpsOut_id = $vpsSingle["\151\144"]; $vpsOut_passwd = $vpsSingle["\x70\x61\163\x73\x77\x64"]; $vpsOut_port = $vpsSingle["\160\157\162\x74"]; goto R5yPWtt66H; qmrDApKPCU: $ret = ssh2_exec($connection, $cmd); stream_set_blocking($ret, true); $ssh_outPut = stream_get_contents($ret); AjoO96qgrg: goto Jd2me8BmnP; tN4nCJy2uM: $arrBack["\x72\x65\164\115\x73\147"] = "\xe5\x87\xba\xe5\217\243\xe7\x9a\204\x76\160\x73\xe7\232\x84\xe6\234\272\xe5\231\250\x20" . $ipSSH . "\40\163\163\150\350\xbf\236\346\x8e\245\345\xa4\xb1\350\264\245"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; lovksOZGv3: goto wFrUyNQ0NS; R5yPWtt66H: $user = "\162\x6f\157\164"; $passwd = openssl_decrypt($vpsOut_passwd, "\x41\x45\123\x2d\x31\x32\70\55\103\102\x43", $json_data["\x61\x69\162\117\x70\145\156\x73\163\154\113\x65\x79"], 0, "\60\61\62\63\64\65\x36\x37\70\x39\x41\102\x43\x44\x45\106"); $connection = @ssh2_connect($vpsOut_ip, intval($vpsOut_port)); $sshCon = @ssh2_auth_password($connection, "{$user}", "{$passwd}"); if ($sshCon) { goto lovksOZGv3; } goto tN4nCJy2uM; wFrUyNQ0NS: $cmd = "\167\x67\145\x74\40\55\117\x20\141\151\162\170\171\x7a\x5f\151\x6e\x73\x74\x61\154\154\137\x73\x2e\163\150\40\x68\164\x74\x70\163\x3a\57\x2f\x72\141\167\x2e\147\x69\164\x68\165\x62\x75\x73\x65\x72\143\157\156\x74\145\156\x74\x2e\143\x6f\x6d\57\141\x69\162\155\x62\57\x61\151\162\x78\171\172\57\155\x61\x69\156\x2f\x61\x69\x72\170\171\172\x5f\x69\x6e\x73\x74\x61\154\154\x5f\163\x2e\163\150"; $ret = ssh2_exec($connection, $cmd); $cmd = "\143\x68\155\157\x64\40\53\170\40\141\151\162\x78\171\x7a\137\x69\156\163\x74\x61\x6c\154\x5f\163\x2e\x73\x68"; $ret = ssh2_exec($connection, $cmd); $cmd = "\x2e\x2f\x61\151\162\x78\x79\x7a\137\x69\x6e\x73\x74\x61\x6c\154\137\x73\x2e\x73\x68\x20\x27\x6f\165\x74\120\x6f\162\164\101\144\144\x27\x20\47" . $port . "\x27\40\47" . $certFile . "\47\x20\47" . $keyFile . "\x27\40\x27" . $vpsOut_server . "\47"; goto qmrDApKPCU; Jd2me8BmnP: } BWE893Jjt1: goto CIienJHGZ0; swK8k4JqME: $sshCon = @ssh2_auth_password($connection, "{$user}", "{$passwd}"); if ($sshCon) { goto o9An5d3Ick; } $arrBack["\162\145\x74\115\x73\147"] = "\xe5\x85\245\xe5\217\243\x76\160\x73\xe7\232\204\xe6\x9c\xba\345\x99\xa8\163\x73\150\350\xbf\x9e\346\216\245\345\xa4\261\xe8\264\245"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); goto rT5wx4r88q; eaEKCqJ3VK: mysqli_close($link); return; JyD07OXV1a: UnYfQYectf: goto GioJL0htq3; goto OdkBjVIaLC; WdpMHyDpxv: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; b2MUV13SkN: $sql = "\x73\x65\x6c\145\x63\164\40\x2a\x20\x66\162\x6f\155\x20\160\x6f\x72\164\x54\x75\156\156\145\154\x4c\x69\x73\x74\40\x77\x68\145\162\x65\x20\160\157\x72\164\124\x75\x6e\156\145\x6c\x4c\x69\163\164\56\x70\x6f\162\164\40\x3d\x20\x27{$port}\47\40\x61\x6e\x64\40\x70\x6f\162\164\x54\x75\x6e\156\145\154\x4c\151\x73\x74\x2e\x6c\151\156\145\111\x44\x20\75\x20\x27{$lineID}\x27"; goto khhuLF0_EO; khhuLF0_EO: $res = mysqli_query($link, $sql); $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto Lk_uzcM3yw; } $arrBack["\162\145\x74\x4d\163\x67"] = "\xe6\xad\244\xe7\xab\xaf\345\x8f\xa3\345\x9c\xa8\xe6\255\xa4\347\272\xbf\350\xb7\257\xe5\267\262\xe7\xbb\x8f\xe6\267\273\xe5\x8a\xa0\xe8\xbf\207\344\272\x86"; echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); goto DQTKJRwnY5; upbckbvY57: $resNum = mysqli_num_rows($res); if ($resNum < 1) { goto CAzNimqDYw; } $result = mysqli_fetch_assoc($res); if ($result["\x69\163\101\144\x6d\x69\x6e"] == "\61") { goto k6z5Jy6JMK; } $arrBack["\162\145\164\x4d\x73\x67"] = "\344\xbd\240\344\xb8\215\346\230\xaf\xe7\256\241\347\x90\x86\345\x91\230"; goto ZQ0WV7ZZnw; AJKqxX80yj: echo json_encode($arrBack, JSON_UNESCAPED_UNICODE); mysqli_close($link); return; Cl7mejettp: $vpsIn_id = ''; goto qiQeCZsu4A; YAAHK7mfMp: $port = $_POST["\160\x6f\x72\164"]; $toIP = $_POST["\164\157\x49\120"]; $toPort = $_POST["\164\157\120\x6f\x72\x74"]; $name = $_POST["\x6e\x61\x6d\x65"]; if ($email) { goto YXGv0V0Iog; } goto wYoXA4IkM0; sSKGUIwYWq: GioJL0htq3: